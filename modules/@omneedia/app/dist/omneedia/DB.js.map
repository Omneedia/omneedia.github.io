{"version":3,"sources":["../../omneedia/DB.ts"],"names":[],"mappings":"AAEA;IAAA;IAgDA,CAAC;IA9CU,MAAG,GAAV,UAAW,GAAU,EAAC,EAAM;QAE9B,cAAc,CAAC;YACd,IAAI,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;YAC/B,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC;YACxB,GAAG,CAAC,gBAAgB,CAAC,cAAc,EAAE,CAAC,CAAC,WAAW,CAAC,CAAC;YACpD,GAAG,CAAC,MAAM,GAAG;gBACZ,EAAE,CAAC,CAAC,GAAG,CAAC,MAAM,KAAK,GAAG,CAAC;oBAAC,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;gBACpD,IAAI,CAAC,CAAC;oBACL,EAAE,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;wBAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;gBAClC,CAAC;YACF,CAAC,CAAC;YACF,EAAE,CAAA,CAAE,CAAC,OAAO,CAAC,CAAC,IAAI,KAAK,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,KAAK,IAAI,CAAE,CAAC;gBAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC;YAAC,IAAI;gBAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;QACjH,CAAC;QAED,EAAE,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,IAAE,CAAC,CAAC,CAAC;YAAC,MAAM,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC;QAE7C,IAAI,IAAI,GAAC;YACT;gBACC,QAAQ,EAAE,WAAW;gBACrB,QAAQ,EAAE,MAAM;gBAChB,MAAM,EAAE;oBACP,EAAC,SAAS,EAAE,GAAG,EAAC;iBAChB;gBACD,MAAM,EAAE,KAAK;gBACb,KAAK,EAAE,CAAC;aACR;SACA,CAAC;QAEF,IAAI,GAAG,GAAC,QAAQ,CAAC,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACzC,GAAG,IAAE,MAAM,CAAC;QACZ,GAAG,GAAC,GAAG,CAAC,OAAO,CAAC,cAAc,EAAE,GAAG,CAAC,CAAC;QAErC,IAAI,CAAC;YACK,IAAI,EAAE,MAAM;YACZ,GAAG,EAAE,GAAG;YACR,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC;YAC1B,WAAW,EAAE,iCAAiC;YAC9C,OAAO,EAAE,UAAU,IAAI;gBAC/B,IAAI,GAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBACb,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC;YACpB,CAAC;SACV,CAAC,CAAC;IAED,CAAC;IAEL,SAAC;AAAD,CAhDA,AAgDC,IAAA","file":"DB.js","sourceRoot":"","sourcesContent":["declare var Settings: any;\n\nexport class DB {\n\t\n    static get(uri:string,cb:any) {\n\t\t\n\t\tfunction ajax(o) {\n\t\t\tvar xhr = new XMLHttpRequest();\n\t\t\txhr.open(o.type, o.url);\n\t\t\txhr.setRequestHeader('Content-Type', o.contentType);\n\t\t\txhr.onload = function() {\n\t\t\t\tif (xhr.status === 200) o.success(xhr.responseText);\n\t\t\t\telse {\n\t\t\t\t\tif (o.error) o.error(xhr.status);\n\t\t\t\t}\n\t\t\t};\n\t\t\tif( (typeof o.data === \"object\") && (o.data !== null) ) xhr.send(JSON.stringify(o.data)); else xhr.send(o.data); \n\t\t}\n\t\t\n\t\tif (uri.indexOf('://')==-1) return cb(false);\n\n\t\tvar post=[\n\t\t{\n\t\t\t\"action\":\t\"__QUERY__\",\n\t\t\t\"method\":\t\"exec\",\n\t\t\t\"data\":\t[\n\t\t\t\t{\"__SQL__\":\turi}\n\t\t\t],\n\t\t\t\"type\":\t\"rpc\",\n\t\t\t\"tid\":\t1\n\t\t}\n\t\t];\n\n\t\tvar url=Settings.DB[uri.split('://')[0]];\n\t\turl+=\"/api\";\n\t\turl=url.replace(/([^:]\\/)\\/+/g, url);\n\t\t\n\t\tajax({\n            type: 'post',\n            url: url,\n            data: JSON.stringify(post),\n            contentType: \"application/json; charset=utf-8\",\n            success: function (data) {\n\t\t\t\tdata=JSON.parse(data);\n            \tcb(data[0].result);\n            }\n\t\t});\n\t\t    \n    }\n\n}"]}